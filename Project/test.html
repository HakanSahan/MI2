<!--
TO DO:

- F7 gebruiken
- Winst Verlies tonen
- fout meldingen tonen
- inlog syteem maken

-->
<!DOCTYPE html>
<html>
<head>
    <script src="js/Javascript.js" type="text/javascript"></script>
    <script src="js/jquery-3.3.1.min.js" type="text/javascript"></script>
    <script>
        "use strict";
        $(document).ready(function () {
            UpdateWallet();
            UpdateOwnedCrypto();
            var request = new XMLHttpRequest();
            request.open('GET','https://api.coinmarketcap.com/v1/ticker/?convert=EUR&limit=50');
            request.onload = function () {
                var crypto = JSON.parse(request.responseText);
                var cryptoAv = "";
                for(var i =0; i <= 49; i++){
                    cryptoLijst.push(crypto[i]);
                    cryptoAv += "<li class='cryptoRow'><div>" + cryptoLijst[i].symbol + "</div>" + "<div>" + cryptoLijst[i].price_eur + "</div></li>";
                    cryptoAv += "<li class='cryptoRow2'><button class='btnKoop'>Koop</button><input type='number' class='aantalKoop'></li>";
                }
                $("#CryptoAv").html(cryptoAv);
            };
            request.send();
            function UpdateOwnedCrypto() {
                var cryptoOwn ="";
                for(var i =0; i<gekochtCryptoLijst.length;i++){
                    cryptoOwn += "<li class='OwendCryptoRow'><div>" + gekochtCryptoLijst[i].id + "</div>" + "<div>" + gekochtCryptoLijst[i].aantal + "</div></li>";
                    cryptoOwn += "<li class='OwendcryptoRow2'><button class='btnVerkoop'>Verkoop</button><input type='number' class='aantalVerkoop'></li>";
                }
                $("#OwendCrypto").html(cryptoOwn);
            }
            $("#CryptoAv").on('click', ".cryptoRow", function () {
                var index = $(".cryptoRow").index(this);
                console.log(index);
                $(".cryptoRow2").eq(index).slideToggle();
            });
            $("#CryptoAv").on('click', ".btnKoop", function () {
                var index = $(".btnKoop").index(this);
                var aantal = parseInt($(".aantalKoop").eq(index).val());
                KoopCyrpto(aantal,cryptoLijst[index]);
                UpdateOwnedCrypto();
                UpdateWallet();
            });
            function UpdateWallet() {
                localStorage.Wallet = JSON.stringify(wallet);
                $("#Wallet").html(wallet.toString());
            }
            $("#OwendCrypto").on('click', ".OwendCryptoRow", function () {
                var index = $(".OwendCryptoRow").index(this);
                $(".OwendcryptoRow2").eq(index).slideToggle();
            });

            $("#OwendCrypto").on('click', ".btnVerkoop", function () {
                var index = $(".btnVerkoop").index(this);
                console.log(index);
                var aantal = parseInt($(".aantalVerkoop").eq(index).val());
                VerkoopCrypto(aantal,gekochtCryptoLijst[index]);
                UpdateOwnedCrypto();
                UpdateWallet();
            });
        });
    </script>
    <style>
        #OwendCrypto{
            display: flex;
            background-color: firebrick;
            flex-flow: column;
        }
        #CryptoAv {
            display: flex;
            background-color:green;
            flex-flow: column;
        }
       .cryptoRow2, .OwendCryptoRow, .cryptoRow{
            display: flex;
            justify-items: stretch;
        }
        div {
            flex-grow: 1;
        }
    </style>
</head>
<body>
    <div id="Wallet"></div>
    <ul id="OwendCrypto">
    </ul>
    <ul id="CryptoAv">
    </ul>
</body>
</html>